"use strict";var WPFormsFormEmbedWizard=window.WPFormsFormEmbedWizard||function(e,o,i){var n={},t={formId:0,isBuilder:!1,isChallengeActive:!1},a={init:function(){i(a.ready),i(o).on("load",a.load)},ready:function(){a.initVars(),a.events()},load:function(){"1"!==wpforms_admin_form_embed_wizard.is_edit_page||t.isChallengeActive||a.initTooltip(),a.initialStateToggle()},initVars:function(){n={$wizardContainer:i("#wpforms-admin-form-embed-wizard-container"),$wizard:i("#wpforms-admin-form-embed-wizard"),$contentInitial:i("#wpforms-admin-form-embed-wizard-content-initial"),$contentSelectPage:i("#wpforms-admin-form-embed-wizard-content-select-page"),$contentCreatePage:i("#wpforms-admin-form-embed-wizard-content-create-page"),$sectionBtns:i("#wpforms-admin-form-embed-wizard-section-btns"),$sectionGo:i("#wpforms-admin-form-embed-wizard-section-go"),$newPageTitle:i("#wpforms-admin-form-embed-wizard-new-page-title"),$selectPage:i("#wpforms-admin-form-embed-wizard-select-page"),$videoTutorial:i("#wpforms-admin-form-embed-wizard-tutorial"),$sectionToggles:i("#wpforms-admin-form-embed-wizard-section-toggles"),$sectionGoBack:i("#wpforms-admin-form-embed-wizard-section-goback"),$shortcode:i("#wpforms-admin-form-embed-wizard-shortcode-wrap"),$shortcodeInput:i("#wpforms-admin-form-embed-wizard-shortcode")},t.isBuilder="undefined"!=typeof WPFormsBuilder,t.isChallengeActive="undefined"!=typeof WPFormsChallenge,t.pagesExists=1===n.$wizard.data("pages-exists")},events:function(){n.$wizard.on("click","button",a.popupButtonsClick).on("click",".tutorial-toggle",a.tutorialToggle).on("click",".shortcode-toggle",a.shortcodeToggle).on("click",".initialstate-toggle",a.initialStateToggle).on("click",".wpforms-admin-popup-close",a.closePopup),e.querySelector("#wpforms-admin-form-embed-wizard-shortcode-copy").addEventListener("click",a.copyShortcodeToClipboard)},popupButtonsClick:function(e){var o=i(e.target);if(o.length){var t=o.closest("div"),e=o.data("action")||"";switch(n.$contentInitial.hide(),e){case"select-page":n.$newPageTitle.hide(),n.$contentSelectPage.show();break;case"create-page":n.$selectPage.hide(),n.$contentCreatePage.show();break;case"go":return n.$selectPage.is(":visible")&&""===n.$selectPage.val()?void 0:(o.prop("disabled",!0),void a.saveFormAndRedirect())}t.hide(),t.next().fadeIn(),n.$sectionToggles.hide(),n.$sectionGoBack.fadeIn(),a.tutorialControl("Stop")}},tutorialToggle:function(e){e.preventDefault(),n.$shortcode.hide(),n.$videoTutorial.toggle(),n.$videoTutorial[0].src.indexOf("&autoplay=1")<0?a.tutorialControl("Play"):a.tutorialControl("Stop")},tutorialControl:function(e){var o=n.$videoTutorial[0];void 0!==o&&("Stop"!==e?o.src+=o.src.indexOf("&autoplay=1")<0?"&autoplay=1":"":o.src=o.src.replace("&autoplay=1",""))},shortcodeToggle:function(e){e.preventDefault(),n.$videoTutorial.hide(),a.tutorialControl("Stop"),n.$shortcodeInput.val('[wpforms id="'+t.formId+'" title="false"]'),n.$shortcode.toggle()},copyShortcodeToClipboard:function(){n.$shortcodeInput.prop("disabled",!1).select().prop("disabled",!0),e.execCommand("copy"),i("#wpforms-admin-form-embed-wizard-shortcode-copy i").removeClass("fa-files-o").addClass("fa-check"),o.setTimeout(function(){i("#wpforms-admin-form-embed-wizard-shortcode-copy i").removeClass("fa-check").addClass("fa-files-o")},2500)},initialStateToggle:function(e){e&&e.preventDefault(),t.pagesExists?(n.$contentInitial.show(),n.$contentSelectPage.hide(),n.$contentCreatePage.hide(),n.$selectPage.show(),n.$newPageTitle.show(),n.$sectionBtns.show(),n.$sectionGo.hide()):(n.$contentInitial.hide(),n.$contentSelectPage.hide(),n.$contentCreatePage.show(),n.$selectPage.hide(),n.$newPageTitle.show(),n.$sectionBtns.hide(),n.$sectionGo.show()),n.$shortcode.hide(),n.$videoTutorial.hide(),a.tutorialControl("Stop"),n.$sectionToggles.show(),n.$sectionGoBack.hide()},saveFormAndRedirect:function(){t.isBuilder&&!WPFormsBuilder.formIsSaved()?t.isBuilder&&t.isChallengeActive?WPFormsBuilder.formSave().done(a.embedPageRedirect):i.confirm({title:!1,content:wpforms_builder.exit_confirm,icon:"fa fa-exclamation-circle",type:"orange",backgroundDismiss:!1,closeIcon:!1,buttons:{confirm:{text:wpforms_builder.save_embed,btnClass:"btn-confirm",keys:["enter"],action:function(){WPFormsBuilder.formSave().done(a.embedPageRedirect)}},cancel:{text:wpforms_builder.embed,action:function(){WPFormsBuilder.setCloseConfirmation(!1),a.embedPageRedirect()}}}}):a.embedPageRedirect()},embedPageRedirectAjaxData:function(){var e={action:"wpforms_admin_form_embed_wizard_embed_page_url",_wpnonce:wpforms_admin_form_embed_wizard.nonce,formId:t.formId};return n.$selectPage.is(":visible")&&(e.pageId=n.$selectPage.val()),n.$newPageTitle.is(":visible")&&(e.pageTitle=n.$newPageTitle.val()),e},embedPageRedirect:function(){var e=a.embedPageRedirectAjaxData();void 0!==e.pageId&&""===e.pageId||i.post(ajaxurl,e,function(e){e.success&&(o.location=e.data)})},openPopup:function(e){e=e||0,t.formId=t.isBuilder?i("#wpforms-builder-form").data("id"):e,n.$wizard.toggleClass("wpforms-challenge-popup",t.isChallengeActive),n.$wizard.find(".wpforms-admin-popup-close").toggle(!t.isChallengeActive),n.$wizard.find(".wpforms-admin-popup-content-regular").toggle(!t.isChallengeActive),n.$wizard.find(".wpforms-admin-popup-content-challenge").toggle(t.isChallengeActive),0===n.$selectPage.length?(n.$sectionBtns.hide(),n.$sectionGo.show()):(n.$sectionBtns.show(),n.$sectionGo.hide()),n.$newPageTitle.show(),n.$selectPage.show(),n.$wizardContainer.fadeIn()},closePopup:function(){n.$wizardContainer.fadeOut(),a.initialStateToggle()},initTooltip:function(){var e=i('<span class="wpforms-admin-form-embed-wizard-dot">&nbsp;</span>'),o=a.isGutenberg(),t=o?".block-editor .edit-post-header":"#wp-content-editor-tools .wpforms-insert-form-button",o={content:i("#wpforms-admin-form-embed-wizard-tooltip-content"),trigger:"custom",interactive:!0,animationDuration:0,delay:0,theme:["tooltipster-default","wpforms-admin-form-embed-wizard"],side:o?"bottom":"right",distance:3,functionReady:function(e,o){e._$tooltip.on("click","button",function(){e.close(),i(".wpforms-admin-form-embed-wizard-dot").remove()}),e.reposition()}};e.insertAfter(t).tooltipster(o).tooltipster("open")},isGutenberg:function(){return"undefined"!=typeof wp&&Object.prototype.hasOwnProperty.call(wp,"blocks")}};return a}(document,window,jQuery);WPFormsFormEmbedWizard.init();